"use strict";
var File = require("./File.js");
var createInterface = require("../Interface.js").createInterface;
var Pool = require("../pool.js");
var JSONFile = createInterface(null,{
    get:function() {
        return maybe(this.data,I,this.file.get()
            .then((objectdata) => {
                this.data = JSON.parse(objectdata);
                return o;
            }));
    },
    setProp:function(k,v) {
        return this.get().then((o) => {
            o[k] = v;
            return this.set(o);
        })
    },
    getProp:function(k) {
        return this.get().then((x) => x[k]);
    },
    set:function(o) {
        return this.file.set(JSON.stringify(o))
            .then(() => this.data=o);
    },
},function(path) {
    this.path = path;
    this.data = null;
})
JSONFile.get = function(path) {
    var j = new JSONFile(path);
    return j.file.stat().then(() => j);
};
JSONFile.createPool = function(p) {
    return new Pool(p,this);
};
module.exports = JSONFile;
